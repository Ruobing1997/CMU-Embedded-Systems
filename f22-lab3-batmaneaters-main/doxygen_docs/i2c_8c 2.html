<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>14642 Lab3: kernel/src/i2c.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">14642 Lab3
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part --><!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_dc43877d82dd332f9fb2071fcca799d6.html">kernel</a></li><li class="navelem"><a class="el" href="dir_3dd30a497388ee684638f120a124721c.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">i2c.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>I2C driver implementation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="i2c_8h_source.html">i2c.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="gpio_8h_source.html">gpio.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="arm_8h_source.html">arm.h</a>&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for i2c.c:</div>
<div class="dyncontent">
<div class="center"><img src="i2c_8c__incl.png" border="0" usemap="#kernel_2src_2i2c_8c" alt=""/></div>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3805872d127fa78471b6bc2f789825a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8c.html#a3805872d127fa78471b6bc2f789825a0">i2c_leader_init</a> ()</td></tr>
<tr class="memdesc:a3805872d127fa78471b6bc2f789825a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function used for i2c leader initialization, we initialize below components: (1) initialize specific physical pin, p0.11 and p0.12 (2) configure SCL and SDA (3) enable TWI.  <a href="i2c_8c.html#a3805872d127fa78471b6bc2f789825a0">More...</a><br /></td></tr>
<tr class="separator:a3805872d127fa78471b6bc2f789825a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae64172a328f99558be9799b3f3b0f714"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8c.html#ae64172a328f99558be9799b3f3b0f714">i2c_leader_stop</a> ()</td></tr>
<tr class="memdesc:ae64172a328f99558be9799b3f3b0f714"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function used for stopping i2c task (1) first we will issue a stop task (2) and then we will wait for specific event to see whether the task completed or not.  <a href="i2c_8c.html#ae64172a328f99558be9799b3f3b0f714">More...</a><br /></td></tr>
<tr class="separator:ae64172a328f99558be9799b3f3b0f714"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe4e90aa9276695138550c429fbd4922"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8c.html#afe4e90aa9276695138550c429fbd4922">i2c_leader_write</a> (uint8_t *tx_buf, uint8_t tx_len, uint8_t follower_addr)</td></tr>
<tr class="memdesc:afe4e90aa9276695138550c429fbd4922"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for i2c leader write (1) we need to configure the follower address and then configure the txd maxcnt and txd data pointer (2) and then we will start the txd task and then wait for the last byte event.  <a href="i2c_8c.html#afe4e90aa9276695138550c429fbd4922">More...</a><br /></td></tr>
<tr class="separator:afe4e90aa9276695138550c429fbd4922"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d39ca0a935245f8eca39b1b5dc466b9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8c.html#a1d39ca0a935245f8eca39b1b5dc466b9">i2c_leader_read</a> (uint8_t *rx_buf, uint8_t rx_len, uint8_t follower_addr)</td></tr>
<tr class="memdesc:a1d39ca0a935245f8eca39b1b5dc466b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function used for i2c leader read (1) we will first configure the follower address and configure the result data pointer (2) and then we start the receive task, waiting for the event to see whether the task completed or not.  <a href="i2c_8c.html#a1d39ca0a935245f8eca39b1b5dc466b9">More...</a><br /></td></tr>
<tr class="separator:a1d39ca0a935245f8eca39b1b5dc466b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>I2C driver implementation. </p>
<dl class="section note"><dt>Note</dt><dd>Not for public release, do not share</dd></dl>
<dl class="section date"><dt>Date</dt><dd>last modified 20 September 2022 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>xingzhi2, ruobing2 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a3805872d127fa78471b6bc2f789825a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3805872d127fa78471b6bc2f789825a0">&#9670;&nbsp;</a></span>i2c_leader_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void i2c_leader_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function used for i2c leader initialization, we initialize below components: (1) initialize specific physical pin, p0.11 and p0.12 (2) configure SCL and SDA (3) enable TWI. </p>
<dl class="section return"><dt>Returns</dt><dd>None </dd></dl>

</div>
</div>
<a id="a1d39ca0a935245f8eca39b1b5dc466b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d39ca0a935245f8eca39b1b5dc466b9">&#9670;&nbsp;</a></span>i2c_leader_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int i2c_leader_read </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>rx_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>rx_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>follower_addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function used for i2c leader read (1) we will first configure the follower address and configure the result data pointer (2) and then we start the receive task, waiting for the event to see whether the task completed or not. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rx_buf</td><td>store result in this rx_buf </td></tr>
    <tr><td class="paramname">rx_len</td><td>length for result buffer </td></tr>
    <tr><td class="paramname">follower_addr</td><td>follower address needed to be configured </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None </dd></dl>

</div>
</div>
<a id="ae64172a328f99558be9799b3f3b0f714"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae64172a328f99558be9799b3f3b0f714">&#9670;&nbsp;</a></span>i2c_leader_stop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void i2c_leader_stop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function used for stopping i2c task (1) first we will issue a stop task (2) and then we will wait for specific event to see whether the task completed or not. </p>
<dl class="section return"><dt>Returns</dt><dd>None </dd></dl>

</div>
</div>
<a id="afe4e90aa9276695138550c429fbd4922"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe4e90aa9276695138550c429fbd4922">&#9670;&nbsp;</a></span>i2c_leader_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int i2c_leader_write </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>tx_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>tx_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>follower_addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for i2c leader write (1) we need to configure the follower address and then configure the txd maxcnt and txd data pointer (2) and then we will start the txd task and then wait for the last byte event. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tx_buf</td><td>store bytes that need to be written </td></tr>
    <tr><td class="paramname">tx_len</td><td>buffer length for bytes written </td></tr>
    <tr><td class="paramname">follower_addr</td><td>follower address needed to be configured </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>return type int. Using this value to see whether the write function is successful or not </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
</div>
<hr class="footer"/><address class="footer"><small>
Generated by <a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>